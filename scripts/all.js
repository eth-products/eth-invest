"use strict";var ethApp=angular.module("ethApp",["chart.js"]);ethApp.component("aboutComponent",{templateUrl:"templates/about/view.html",controller:["LangService",function(t){this.menu=t().header.menu}]}),ethApp.component("circleComponent",{templateUrl:"templates/base/circle/view.html",bindings:{type:"=",side:"=",id:"="},controllerAs:"$ctrl",transclude:!0,controller:["getElementPosition","$rootScope","$element","$timeout",function(s,e,i,n){var r=!1,p=null,m=null,d=this;d.elements=null,d.$onInit=function(){switch(d.type){case"line":a=e.$on("currentScrollPosition",function(t,e){if(r)return a(),!1;p=i[0].querySelector(".circle-animate-element-line"),m=i[0].querySelector(".circle-animate-element-circle");var n=document.getElementById(d.id),o=s(n);!r&&e.bottom>=o.top&&(r=!0,p.style.width=o.left-50+"px",m.style.opacity="1",m.style.filter="alpha(opacity=100)")});break;case"circle":t=document.getElementById(d.id),c=t.clientHeight,l=s(t),d.elements=_.range(0,_.random(2,7)),d.elements=_.map(d.elements,function(t,e){var n=_.random(10,120)+"px",o=_.random(0,screen.width)+"px",a=_.random(0,c)+"px",i=_.random(.1,4);return{idx:e,speed:i,size:n,style:{width:n,height:n,left:o,top:a}}}),n(function(){d.elements=_.map(d.elements,function(t,e){return t.element=document.getElementById("circle-animate-idx-"+d.id+"-"+t.idx),t}),e.$on("currentScrollPosition",function(t,e){if(e.bottom>=l.top&&e.top<=l.bottom){var c="up"===e.direction;_.each(d.elements,function(t,e){var n=parseFloat(d.elements[e].element.style.top),o=c?t.speed:-t.speed,a=n+o,i=s(t.element);i.top+o>=l.bottom?a=-t.element.clientHeight/2:i.bottom+o<=l.top&&(a=l.h-t.element.clientHeight/2),d.elements[e].element.style.top=a+"px"})}})})}var t,c,l,a}}]}),ethApp.component("iconAnimateComponent",{templateUrl:"templates/base/icon/view.html",controllerAs:"$ctrl",bindings:{name:"=",id:"="},controller:["$rootScope","$element","getElementPosition","$q",function(n,o,a,t){var i=this,c=null,l=null,s=null,r=null,p=null;function m(t){if(t.bottom>=r.top){var e=window.innerHeight,n=r.top-t.top;if(n<0)return!1;var o=p*(100-n/e*100)/100;c.playSegments([o-1e-6,o])}else c.playSegments([p-1e-6,p])}i.$onInit=function(){l=n.iconList[i.name],new t(function(t){n.iconList[i.name].data.op||(n.iconList[i.name].data=n.loadedData.json[i.name]),t(n.iconList[i.name].data)}).then(function(t){var e={container:o[0],renderer:"svg",loop:l.loop,autoplay:l.play,animationData:t};c=lottie.loadAnimation(e),l.scroll&&function(){if(!i.id)throw"id is undefined";s=document.getElementById(i.id),r=a(s),p=l.data.op;var t=document.body.scrollTop||document.documentElement.scrollTop,e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;m({top:t,bottom:t+e}),n.$on("currentScrollPosition",function(t,e){m(e)})}()})}}]}),ethApp.component("tableComponent",{templateUrl:"templates/base/table/view.html",bindings:{data:"="},controller:["$rootScope",function(t){t.lang="RU",this.$onInit=function(){}}]}),ethApp.component("dashboardComponent",{templateUrl:"templates/dashboard/view.html",controller:["$rootScope","$http",function(t,e){var n=this;t.lang="RU",n.$onInit=function(){e.get("assets/data/information.json").then(function(t){console.log("res",t);var e=t.data;n.dashboard={data:e.history_transactions.data,labels:e.history_transactions.labels,options:{maintainAspectRatio:!1,scaleFontColor:"white",elements:{line:{fill:!1,borderWidth:4,borderColor:"orange"},point:{radius:0}},scales:{yAxes:[{id:"y-axis-2",type:"linear",display:!0,position:"left",ticks:{fontColor:"white"},gridLines:{color:"#b767ca"}}],xAxes:[{gridLines:{display:!1},ticks:{fontColor:"white"}}]}}}})},n.buttonsList={0:{id:0,name:"Вложено Etherium",active:!0},3:{id:3,name:"Калькулятор дохода",table:!1,active:!1,fields:{percents:{0:{id:0,value:3,active:!0},1:{id:1,value:3.5}},count:.005,days:1}}},n.activeButton=n.buttonsList[0],n.changeTypeDashboard=function(t){if(n.buttonsList[t.id].active)return!1;_.each(n.buttonsList,function(t,e){n.buttonsList[e].active=!1}),n.buttonsList[t.id].active=!0,n.activeButton=t},n.calcIncome=function(){return 3===n.activeButton.id&&(n.activeButton.table?n.activeButton.table=!1:(n.activeButton.tableData={heads:{day:"День",income:"Общий доход"}},n.activeButton.tableData.body=_.map(_.range(0,n.activeButton.fields.days),function(t){var e=_.find(n.activeButton.fields.percents,"active").value;return{day:t,income:n.activeButton.fields.count*e/100*t}}),void(n.activeButton.table=!n.activeButton.table)))},n.updPercentButton=function(t){if(3!==n.activeButton.id)return!1;_.each(n.activeButton.fields.percents,function(t,e){n.activeButton.fields.percents[e].active=!1}),t.active=!0}}]}),ethApp.component("headerComponent",{templateUrl:"templates/header/view.html",controller:["LangService",function(t){this.menu=t().header.menu}]}),ethApp.component("howComponent",{templateUrl:"templates/how/view.html",controller:["$rootScope",function(t){t.lang="RU"}]}),ethApp.component("infoSectionComponent",{templateUrl:"templates/info-section/view.html",controller:["$rootScope",function(t){t.lang="RU"}]}),ethApp.component("investComponent",{templateUrl:"templates/invest/view.html",controller:["$rootScope",function(t){t.lang="RU"}]}),ethApp.component("latestTransactionComponent",{templateUrl:"templates/latest-transaction/view.html",controller:["$rootScope",function(t){var e=this;t.lang="RU",e.$onInit=function(){e.dataTable={heads:{time:"Время",count:"Количество",address:"Адрес"},body:[{time:"20.11.2018",count:"0.33",address:'<a href="" class="transaction-link">0x42342995843453475345438680x42342995843453475345438680x4234299584345347534543868</a>'},{time:"20.11.2018",count:"0.33",address:'<a href="" class="transaction-link">0x42342995843453475345438680x42342995843453475345438680x4234299584345347534543868</a>'},{time:"20.11.2018",count:"0.33",address:'<a href="" class="transaction-link">0x42342995843453475345438680x42342995843453475345438680x4234299584345347534543868</a>'},{time:"20.11.2018",count:"0.33",address:'<a href="" class="transaction-link">0x42342995843453475345438680x42342995843453475345438680x4234299584345347534543868</a>'},{time:"20.11.2018",count:"0.33",address:'<a href="" class="transaction-link">0x42342995843453475345438680x42342995843453475345438680x4234299584345347534543868</a>'},{time:"20.11.2018",count:"0.33",address:'<a href="" class="transaction-link">0x42342995843453475345438680x42342995843453475345438680x4234299584345347534543868</a>'},{time:"20.11.2018",count:"0.33",address:'<a href="" class="transaction-link">0x42342995843453475345438680x42342995843453475345438680x4234299584345347534543868</a>'}]}}}]}),ethApp.component("mainComponent",{templateUrl:"templates/main/view.html",controller:["$rootScope","$scope",function(t){t.lang="RU"}]}),ethApp.component("reviewComponent",{templateUrl:"templates/review/view.html",controller:["LangService",function(t){this.menu=t().header.menu}]}),ethApp.component("topSectionComponent",{templateUrl:"templates/top-section/view.html",controller:["LangService",function(t){this.menu=t().header.menu}]}),ethApp.run(["$rootScope",function(a){var i=0;a.$broadcast("currentScrollPosition"),document.addEventListener("scroll",function(t){var e=document.body.scrollTop||document.documentElement.scrollTop,n=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,o=null;o=0<e&&i<=e?"down":"up",i=e,a.$emit("currentScrollPosition",{top:e,bottom:e+n,direction:o})})}]),ethApp.run(["$rootScope",function(t){t.iconList={"eth-logo":{id:"eth-logo",loop:!0,play:!0,data:{}},about:{id:"about",loop:!1,play:!0,scroll:!0,data:{}},info:{id:"info",loop:!1,play:!0,scroll:!0,data:{}},wallet:{id:"wallet",loop:!1,play:!0,scroll:!0,data:{}},card:{id:"card",loop:!1,play:!0,scroll:!0,data:{}},eth:{id:"eth",loop:!1,play:!0,scroll:!0,data:{}},money:{id:"money",loop:!1,play:!0,scroll:!0,data:{}},field:{id:"field",loop:!1,play:!0,scroll:!0,data:{}}}}]),ethApp.run(["$rootScope","$http","LoaderService","$timeout",function(e,a,n,o){n.show();var i="icon/json",c="image",t=[{name:"about",path:"assets/icons/about.json",type:i},{name:"card",path:"assets/icons/card.json",type:i},{name:"eth",path:"assets/icons/eth.json",type:i},{name:"eth-logo",path:"assets/icons/eth-logo.json",type:i},{name:"field",path:"assets/icons/field.json",type:i},{name:"info",path:"assets/icons/info.json",type:i},{name:"money",path:"assets/icons/money.json",type:i},{name:"wallet",path:"assets/icons/wallet.json",type:i},{name:"information",path:"assets/data/information.json",type:i},{name:"transactions",path:"assets/data/transactions.json",type:i},{name:"about-background",path:"images/about/background.png",type:c},{name:"attention-background",path:"images/attention-section/attention.png",type:c},{name:"dashboard-background",path:"images/dashboard-section/background.png",type:c},{name:"how-background",path:"images/how-section/background.png",type:c},{name:"information-background",path:"images/information/background.png",type:c},{name:"info-icon-days",path:"images/information/icons/days.png",type:c},{name:"info-icon-1",path:"images/information/icons/icon-1.png",type:c},{name:"info-icon-2",path:"images/information/icons/icon-2.png",type:c},{name:"info-icon-3",path:"images/information/icons/icon-3.png",type:c},{name:"invest-background",path:"images/invest-section/background.png",type:c},{name:"top-background",path:"images/top-section/background.png",type:c},{name:"top-icon-1",path:"images/top-section/icons/icon-1.png",type:c},{name:"top-icon-2",path:"images/top-section/icons/icon-2.png",type:c},{name:"top-icon-3",path:"images/top-section/icons/icon-3.png",type:c},{name:"top-icon-4",path:"images/top-section/icons/icon-4.png",type:c},{name:"logo-eth",path:"images/logo-eth.png",type:c}],l=[];e.loadedData={images:{},json:{}},_.each(t,function(o){l.push(new Promise(function(n){if(o.type===c)a.get(o.path,{responseType:"blob"}).then(function(t){var e=(window.URL||window.webkitURL).createObjectURL(t.data);n({file:e,type:o.type,name:o.name})});else{var e="json-icon-"+o.name,t=JSON.parse(localStorage.getItem("json-icon-"+o.name));t?n({file:t,type:o.type,name:o.name}):a.get(o.path).then(function(t){localStorage.setItem(e,JSON.stringify(t.data)),n({file:t.data,type:o.type,name:o.name})})}}))}),Promise.all(l).then(function(t){_.each(t,function(t){switch(t.type){case i:e.loadedData.json[t.name]=t.file;break;case c:e.loadedData.images[t.name]=t;break;default:console.error("unknown type file")}}),o(function(){n.hide()},1e3)})}]),ethApp.controller("MainController",["$scope","$rootScope",function(n,t){n.loaded=!1,n.$watch(function(){return t.loaded},function(t,e){n.loaded=t})}]),ethApp.filter("backgroundSectionUrl",["$rootScope",function(n){return function(t,e){switch(e){case"img":return n.loadedData.images[t].file;default:return{background:'url("'+n.loadedData.images[t].file+'")'}}}}]),ethApp.filter("rootScopeFilter",["$rootScope",function(e){return function(t){return e[t]}}]),ethApp.filter("trustHtml",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]),ethApp.service("getElementPosition",[function(){return function(t){for(var e=0,n=0,o=t.width||t.offsetWidth,a=t.height||t.offsetHeight;t&&!isNaN(t.offsetLeft)&&!isNaN(t.offsetTop);)e+=t.offsetLeft-t.scrollLeft,n+=t.offsetTop-t.scrollTop,t=t.offsetParent;return{top:n,left:e,right:e+o,bottom:n+a,w:o,h:a}}}]),ethApp.service("LoaderService",["$rootScope",function(t){var e=document.getElementById("eth-app-loader");return{show:function(){e.style.opacity="1",t.$apply(function(){t.loaded=!1})},hide:function(){e.style.opacity="0",t.$apply(function(){t.loaded=!0})}}}]),ethApp.service("LangService",["$rootScope",function(t){return function(){return{RU:{header:{menu:[{name:"О фонде",id:"about-section"},{name:"Вложения в проект",id:"invest-section"},{name:"Как осуществить вклад",id:"how-section"},{name:"Транзакции",id:"transactions-section"},{name:"График",id:"dashboard-section"}]}},EN:{}}[t.lang]}}]);