"use strict";var ethApp=angular.module("ethApp",["chart.js"]);ethApp.component("aboutComponent",{templateUrl:"templates/about/view.html",controller:["LangService",function(t){this.menu=t().header.menu}]}),ethApp.component("circleComponent",{templateUrl:"templates/base/circle/view.html",bindings:{type:"=",side:"=",id:"="},controllerAs:"$ctrl",transclude:!0,controller:["getElementPosition","$rootScope","$element","$timeout",function(r,e,i,n){var s=!1,p=null,d=null,m=this;m.elements=null,m.$onInit=function(){switch(m.type){case"line":a=e.$on("currentScrollPosition",function(t,e){if(s)return a(),!1;p=i[0].querySelector(".circle-animate-element-line"),d=i[0].querySelector(".circle-animate-element-circle");var n=document.getElementById(m.id),o=r(n);!s&&e.bottom>=o.top&&(s=!0,p.style.width=o.left-50+"px",d.style.opacity="1",d.style.filter="alpha(opacity=100)")});break;case"circle":t=document.getElementById(m.id),c=t.clientHeight,l=r(t),m.elements=_.range(0,_.random(2,7)),m.elements=_.map(m.elements,function(t,e){var n=_.random(10,120)+"px",o=_.random(0,screen.width)+"px",a=_.random(0,c)+"px",i=_.random(.1,4);return{idx:e,speed:i,size:n,style:{width:n,height:n,left:o,top:a}}}),n(function(){m.elements=_.map(m.elements,function(t,e){return t.element=document.getElementById("circle-animate-idx-"+m.id+"-"+t.idx),t}),e.$on("currentScrollPosition",function(t,e){if(e.bottom>=l.top&&e.top<=l.bottom){var c="up"===e.direction;_.each(m.elements,function(t,e){var n=parseFloat(m.elements[e].element.style.top),o=c?t.speed:-t.speed,a=n+o,i=r(t.element);i.top+o>=l.bottom?a=-t.element.clientHeight/2:i.bottom+o<=l.top&&(a=l.h-t.element.clientHeight/2),m.elements[e].element.style.top=a+"px"})}})})}var t,c,l,a}}]}),ethApp.component("iconAnimateComponent",{templateUrl:"templates/base/icon/view.html",controllerAs:"$ctrl",bindings:{name:"=",id:"="},controller:["$rootScope","$element","getElementPosition","$q",function(n,o,a,t){var i=this,c=null,l=null,r=null,s=null,p=null;function d(t){if(t.bottom>=s.top){var e=window.innerHeight,n=s.top-t.top;if(n<0)return!1;var o=p*(100-n/e*100)/100;c.playSegments([o-1e-6,o])}else c.playSegments([p-1e-6,p])}i.$onInit=function(){l=n.iconList[i.name],new t(function(t){n.iconList[i.name].data.op||(n.iconList[i.name].data=n.loadedData.json[i.name]),t(n.iconList[i.name].data)}).then(function(t){var e={container:o[0],renderer:"svg",loop:l.loop,autoplay:l.play,animationData:t};c=lottie.loadAnimation(e),l.scroll&&function(){if(!i.id)throw"id is undefined";r=document.getElementById(i.id),s=a(r),p=l.data.op;var t=document.body.scrollTop||document.documentElement.scrollTop,e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;d({top:t,bottom:t+e}),n.$on("currentScrollPosition",function(t,e){d(e)})}()})}}]}),ethApp.component("tableComponent",{templateUrl:"templates/base/table/view.html",bindings:{data:"="},controller:["$rootScope",function(t){t.lang="RU",this.$onInit=function(){}}]}),ethApp.component("dashboardComponent",{templateUrl:"templates/dashboard/view.html",controller:["$rootScope",function(e){var n=this;e.lang="RU",n.$onInit=function(){var t;n.dashboard={data:(t=e.loadedData.json.data.file).sumList,labels:t.sumList,options:{maintainAspectRatio:!1,scaleFontColor:"white",elements:{line:{fill:!1,borderWidth:4,borderColor:"orange"},point:{radius:0}},scales:{yAxes:[{id:"y-axis-2",type:"linear",display:!0,position:"left",ticks:{fontColor:"white"},gridLines:{color:"#b767ca"}}],xAxes:[{gridLines:{display:!1},ticks:{fontColor:"white"}}]}}}},n.buttonsList={0:{id:0,name:"Вложено Etherium",active:!0},3:{id:3,name:"Калькулятор дохода",table:!1,active:!1,fields:{percents:{0:{id:0,value:3,active:!0},1:{id:1,value:4}},count:.005,days:1}}},n.activeButton=n.buttonsList[0],n.changeTypeDashboard=function(t){if(n.buttonsList[t.id].active)return!1;_.each(n.buttonsList,function(t,e){n.buttonsList[e].active=!1}),n.buttonsList[t.id].active=!0,n.activeButton=t},n.calcIncome=function(){return 3===n.activeButton.id&&(n.activeButton.table?n.activeButton.table=!1:(n.activeButton.tableData={heads:{day:"День",income:"Общий доход"}},n.activeButton.tableData.body=_.map(_.range(0,n.activeButton.fields.days),function(t){var e=_.find(n.activeButton.fields.percents,"active").value;return{day:t,income:(n.activeButton.fields.count*e/100*t).toFixed(2)}}),void(n.activeButton.table=!n.activeButton.table)))},n.updPercentButton=function(t){if(3!==n.activeButton.id)return!1;_.each(n.activeButton.fields.percents,function(t,e){n.activeButton.fields.percents[e].active=!1}),t.active=!0}}]}),ethApp.component("headerComponent",{templateUrl:"templates/header/view.html",controller:["LangService",function(t){this.menu=t().header.menu}]}),ethApp.component("howComponent",{templateUrl:"templates/how/view.html",controller:["$rootScope",function(t){var e=this;e.$onInit=function(){e.addr=t.addr},t.lang="RU"}]}),ethApp.component("infoSectionComponent",{templateUrl:"templates/info-section/view.html",controller:["$rootScope",function(o){var a=this;o.lang="RU",a.$onInit=function(){a.data=o.loadedData.json.data.file;var t=new Date,e=new Date(a.data.startDate),n=Math.abs(e.getTime()-t.getTime());a.data.startDate=Math.ceil(n/864e5)}}]}),ethApp.component("investComponent",{templateUrl:"templates/invest/view.html",controller:["$rootScope",function(t){var e=this;e.$onInit=function(){e.addr=t.addr},t.lang="RU"}]}),ethApp.component("latestTransactionComponent",{templateUrl:"templates/latest-transaction/view.html",controller:["$rootScope","$filter",function(t,n){var o=this,a={bonus:"Приглашение",invest:"Инвестирование",dividends:"Дивиденды"};t.lang="RU",o.$onInit=function(){o.dataTable={heads:{time:"Время",count:"Количество",type:"Тип",address:"Адрес"},body:[]},_.each(t.loadedData.json.data.file.latestTransactions,function(t){var e={time:n("date")(t.date,"HH:mm"),count:t.val,type:a[t.type],address:"<a href='https://etherscan.io/address/".concat(t.who,"'>").concat(t.who,"</a>")};o.dataTable.body.push(e)})}}]}),ethApp.component("mainComponent",{templateUrl:"templates/main/view.html",controller:["$rootScope","$scope",function(t){t.lang="RU"}]}),ethApp.component("reviewComponent",{templateUrl:"templates/review/view.html",controller:["LangService",function(t){this.menu=t().header.menu}]}),ethApp.component("topSectionComponent",{templateUrl:"templates/top-section/view.html",controller:["LangService","$rootScope",function(t,e){var n=this;n.$onInit=function(){n.addr=e.addr},n.menu=t().header.menu}]}),ethApp.run(["$rootScope",function(t){t.addr="0xB4B55084F5910D80aEE29B3923eE64773571B9F7"}]),ethApp.run(["$rootScope",function(a){var i=0;a.$broadcast("currentScrollPosition"),document.addEventListener("scroll",function(t){var e=document.body.scrollTop||document.documentElement.scrollTop,n=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,o=null;o=0<e&&i<=e?"down":"up",i=e,a.$emit("currentScrollPosition",{top:e,bottom:e+n,direction:o})})}]),ethApp.run(["$rootScope",function(t){t.iconList={"eth-logo":{id:"eth-logo",loop:!0,play:!0,data:{}},about:{id:"about",loop:!1,play:!0,scroll:!0,data:{}},info:{id:"info",loop:!1,play:!0,scroll:!0,data:{}},wallet:{id:"wallet",loop:!1,play:!0,scroll:!0,data:{}},card:{id:"card",loop:!1,play:!0,scroll:!0,data:{}},eth:{id:"eth",loop:!1,play:!0,scroll:!0,data:{}},money:{id:"money",loop:!1,play:!0,scroll:!0,data:{}},field:{id:"field",loop:!1,play:!0,scroll:!0,data:{}}}}]),ethApp.run(["$rootScope","$http","LoaderService","$timeout",function(e,a,n,o){n.show();var i="icon/json",c="data/json",l="image",t=[{name:"data",path:"assets/data/info.json?v="+_.random(0,1e4),type:c},{name:"about",path:"assets/icons/about.json",type:i},{name:"card",path:"assets/icons/card.json",type:i},{name:"eth",path:"assets/icons/eth.json",type:i},{name:"eth-logo",path:"assets/icons/eth-logo.json",type:i},{name:"field",path:"assets/icons/field.json",type:i},{name:"info",path:"assets/icons/info.json",type:i},{name:"money",path:"assets/icons/money.json",type:i},{name:"wallet",path:"assets/icons/wallet.json",type:i},{name:"about-background",path:"images/about/background.png",type:l},{name:"attention-background",path:"images/attention-section/attention.png",type:l},{name:"dashboard-background",path:"images/dashboard-section/background.png",type:l},{name:"how-background",path:"images/how-section/background.png",type:l},{name:"information-background",path:"images/information/background.png",type:l},{name:"info-icon-days",path:"images/information/icons/days.png",type:l},{name:"info-icon-1",path:"images/information/icons/icon-1.png",type:l},{name:"info-icon-2",path:"images/information/icons/icon-2.png",type:l},{name:"info-icon-3",path:"images/information/icons/icon-3.png",type:l},{name:"invest-background",path:"images/invest-section/background.png",type:l},{name:"top-background",path:"images/top-section/background.png",type:l},{name:"top-icon-1",path:"images/top-section/icons/icon-1.png",type:l},{name:"top-icon-2",path:"images/top-section/icons/icon-2.png",type:l},{name:"top-icon-3",path:"images/top-section/icons/icon-3.png",type:l},{name:"top-icon-4",path:"images/top-section/icons/icon-4.png",type:l},{name:"logo-eth",path:"images/logo-eth.png",type:l}],r=[];e.loadedData={images:{},json:{}},_.each(t,function(o){r.push(new Promise(function(n){if(o.type===l)a.get(o.path,{responseType:"blob"}).then(function(t){var e=(window.URL||window.webkitURL).createObjectURL(t.data);n({file:e,type:o.type,name:o.name})});else if(o.type===i){var e="json-icon-"+o.name,t=JSON.parse(localStorage.getItem("json-icon-"+o.name));t?n({file:t,type:o.type,name:o.name}):a.get(o.path).then(function(t){localStorage.setItem(e,JSON.stringify(t.data)),n({file:t.data,type:o.type,name:o.name})})}else a.get(o.path).then(function(t){n({file:t.data,type:o.type,name:o.name})})}))}),Promise.all(r).then(function(t){_.each(t,function(t){switch(t.type){case i:e.loadedData.json[t.name]=t.file;break;case l:e.loadedData.images[t.name]=t;break;case c:e.loadedData.json[t.name]=t;break;default:console.error("unknown type file")}}),n.hide(),o(function(){n.hideLoader()},2400)})}]),ethApp.controller("MainController",["$scope","$rootScope",function(n,t){n.loaded=!1,n.$watch(function(){return t.loaded},function(t,e){n.loaded=t}),n.$watch(function(){return t.spinner},function(t,e){n.spinner=t})}]),ethApp.filter("backgroundSectionUrl",["$rootScope",function(n){return function(t,e){switch(e){case"img":return n.loadedData.images[t].file;default:return{background:'url("'+n.loadedData.images[t].file+'")',"background-size":"cover"}}}}]),ethApp.filter("declWordsFilter",[function(){return function(t){var e=t.number;return t.words[4<e%100&&e%100<20?2:[2,0,1,1,1,2][Math.min(e%10,5)]]}}]),ethApp.filter("rootScopeFilter",["$rootScope",function(e){return function(t){return e[t]}}]),ethApp.filter("trustHtml",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]),ethApp.service("getElementPosition",[function(){return function(t){for(var e=0,n=0,o=t.width||t.offsetWidth,a=t.height||t.offsetHeight;t&&!isNaN(t.offsetLeft)&&!isNaN(t.offsetTop);)e+=t.offsetLeft-t.scrollLeft,n+=t.offsetTop-t.scrollTop,t=t.offsetParent;return{top:n,left:e,right:e+o,bottom:n+a,w:o,h:a}}}]),ethApp.service("LoaderService",["$rootScope",function(t){t.spinner=!0;var e=document.getElementById("eth-app-loader");return{show:function(){e.style.opacity="1",t.$apply(function(){t.loaded=!1})},hideLoader:function(){t.spinner=!1},hide:function(){e.style.opacity="0",t.$apply(function(){t.loaded=!0})}}}]),ethApp.service("LangService",["$rootScope",function(t){return function(){return{RU:{header:{menu:[{name:"О фонде",id:"about-section"},{name:"Вложения в проект",id:"invest-section"},{name:"Как осуществить вклад",id:"how-section"},{name:"Транзакции",id:"transactions-section"},{name:"График",id:"dashboard-section"}]}},EN:{}}[t.lang]}}]);